
@using CleanTechSim.MainPage.Models
@model PreparedDataPoints

@{
    string elementId = Model.GraphId;
}
<div>

    <canvas id="@elementId"></canvas>

    <script>
        var ctx = document.getElementById('@elementId').getContext('2d');

        var chart = new Chart(ctx, {
            type : 'line',
            data : {
                'labels' : [
                    @for (int i = 0; i < Model.Labels.Count(); i++)
                    {
                        if (i > 0) {
                            <text>, </text>
                        }
                        
                        <text>'@Model.Labels.ElementAt(i)'</text>
                    }
                ],

                'datasets' : [

                @for (int i = 0; i < Model.DataSets.Count(); ++ i)
                {
                    DataSet dataSet = Model.DataSets.ElementAt(i);

                    if (i > 0) {
                        <text>, </text>
                    }
                    <text>{

                        'label' : '@dataSet.Label',
                        'borderColor' : 'rgb(@dataSet.Color.R, @dataSet.Color.G, @dataSet.Color.B)',
                        
                        'fill' : false,

                        'data' : [</text>
                    
                    for (int j = 0; j < dataSet.Values.Count(); ++ j) {
                        decimal? value = dataSet.Values.ElementAt(j);

                        string valueString = value.HasValue ? value.Value.ToString() : "null";

                        if (j > 0) {
                            <text>, </text>
                        }
                        <text>@value</text>
                    }

                    <text>]</text>

                    <text>}</text>
                }
                /*
                {
                    label : 'test123',
                    // backgroundColor : 'rgb(100, 100, 100)',
                    // borderColor : 'rgb(100, 100, 100)',
                    data : [ 1, 3.8, 2  ]
                }
                */
                ]
            },

            options : {
                'spanGaps' : true
            }

        });    
    </script>

</div>
